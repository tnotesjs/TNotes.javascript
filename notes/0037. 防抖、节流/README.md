# [0037. é˜²æŠ–ã€èŠ‚æµ](https://github.com/Tdahuyou/TNotes.html-css-js/tree/main/notes/0037.%20%E9%98%B2%E6%8A%96%E3%80%81%E8%8A%82%E6%B5%81)

<!-- region:toc -->

- [1. ğŸ“ æ¦‚è¿°](#1--æ¦‚è¿°)
- [2. ğŸ”— leetcode ç›¸å…³ä¾‹é¢˜](#2--leetcode-ç›¸å…³ä¾‹é¢˜)
- [3. ğŸ“’ é˜²æŠ–](#3--é˜²æŠ–)
- [4. ğŸ“’ èŠ‚æµ](#4--èŠ‚æµ)
- [5. ğŸ“’ é˜²æŠ– vs. èŠ‚æµ](#5--é˜²æŠ–-vs-èŠ‚æµ)
- [6. ğŸ’» demos.1 - é˜²æŠ–](#6--demos1---é˜²æŠ–)
- [7. ğŸ’» demos.2 - èŠ‚æµ](#7--demos2---èŠ‚æµ)

<!-- endregion:toc -->

## 1. ğŸ“ æ¦‚è¿°

- çŸ¥è¯†ç‚¹ï¼š
  - ç†è§£é˜²æŠ–
  - ç†è§£èŠ‚æµ
  - å®Œæˆ leetcode ç®—æ³•é¢˜
- é˜²æŠ–ï¼ˆdebouncingï¼‰å’ŒèŠ‚æµï¼ˆthrottlingï¼‰éƒ½æ˜¯ç”¨æ¥æ§åˆ¶å‡½æ•°è°ƒç”¨é¢‘ç‡çš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆã€‚
  - ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2024-12-31-17-34-54.png)

## 2. ğŸ”— leetcode ç›¸å…³ä¾‹é¢˜

- https://www.yuque.com/huyouda/leetcode/2627
  - leetcodeï¼Œå®ç°å‡½æ•°é˜²æŠ–ã€‚
- https://www.yuque.com/huyouda/leetcode/2676
  - leetcodeï¼Œå®ç°å‡½æ•°èŠ‚æµã€‚

## 3. ğŸ“’ é˜²æŠ–

- **é˜²æŠ–æ˜¯ä»€ä¹ˆ**
  - é˜²æŠ–æ˜¯æŒ‡çŸ­æ—¶é—´å†…å¤§é‡è§¦å‘åŒä¸€äº‹ä»¶ï¼Œåªä¼šåœ¨ **æœ€åä¸€æ¬¡äº‹ä»¶å®Œæˆå** å»¶è¿Ÿæ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚
- **é˜²æŠ–çš„åº”ç”¨åœºæ™¯**
  - ä¾‹å¦‚ï¼Œåœ¨è¾“å…¥ç”¨æˆ·åçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åå¤éªŒè¯ç”¨æˆ·åã€‚æ­¤æ—¶åº”è¯¥ç­‰å¾…ç”¨æˆ·åœæ­¢è¾“å…¥ï¼Œç„¶åè¿›è¡ŒéªŒè¯ï¼Œå¦åˆ™å°†å½±å“ç”¨æˆ·ä½“éªŒåŠç¨‹åºæ€§èƒ½ã€‚
- **é˜²æŠ–çš„å®ç°**
  - é˜²æŠ–å®ç°çš„åŸç†æ˜¯åœ¨æ¯æ¬¡è§¦å‘äº‹ä»¶åï¼Œæ¸…ç©ºä¹‹å‰çš„è®¡æ—¶å™¨ï¼Œå¹¶é‡å¯ä¸€ä¸ªæ–°çš„è®¡æ—¶å™¨ã€‚åœ¨ delay æ—¶é—´å†…ï¼Œè‹¥äº‹ä»¶è§¦å‘å¤šæ¬¡ï¼Œåªæœ‰æœ€æœ‰ä¸€æ¬¡çš„äº‹ä»¶ä¼šåœ¨å»¶è¿Ÿ delay æ—¶é—´åè¢«æ‰§è¡Œã€‚

```javascript
var debounce = function (fn, delay) {
  let timer
  return function (...args) {
    clearTimeout(timer)
    timer = setTimeout((_) => fn(...args), delay)
  }
}
```

## 4. ğŸ“’ èŠ‚æµ

- **èŠ‚æµæ˜¯ä»€ä¹ˆ**
  - å¯ä»¥é€šè¿‡ç±»æ¯”æ¥ç†è§£â€œèŠ‚æµâ€è¿™ä¸ªè¯ï¼Œå®ƒå°±å¥½æ¯”æœªæ‹§ç´§çš„æ°´é¾™å¤´ä¸€æ ·ï¼Œæ°´é¾™å¤´æ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šæ»´æ°´ï¼ˆèŠ‚æµæ˜¯æ¯éš”ä¸€æ®µæ—¶é—´å°±æ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼‰ã€‚å³ä½¿åœ¨è¿™æ®µæ—¶é—´ç®¡é“é‡Œæœ‰æ›´å¤šçš„æ°´ï¼Œæ°´é¾™å¤´ä¹Ÿä¸ä¼šæ‰æ›´å¤šçš„æ°´ã€‚
- **èŠ‚æµçš„ä¸€äº›ç»†èŠ‚**
  - èŠ‚æµæ˜¯æœ‰åˆ†ç±»çš„ï¼Œå¯ä»¥æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬è®¾å®šçš„å»¶è¿Ÿæ—¶é—´æ˜¯ 50msï¼ŒæŸä¸ªäº‹ä»¶ fn åœ¨ 10msã€30ms è§¦å‘ï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹ä»¶çš„åˆ†åˆ«ä¼šåœ¨ä»€ä¹ˆæ—¶åˆ»è¢«æ‰§è¡Œå‘¢ï¼Ÿ
- **é—®ï¼šé¦–æ¬¡è§¦å‘æ—¶ï¼Œä¹Ÿå°±æ˜¯ 10ms æ—¶ï¼Œæ˜¯å¦éœ€è¦æ‰§è¡Œï¼Ÿ**
  - ç­”ï¼šéƒ½è¡Œï¼Œçœ‹å…·ä½“è¦æ±‚ã€‚æ¯”å¦‚ LeetCode ä¸Šçš„é¢˜ç›®å°±è¦æ±‚åœ¨é¦–æ¬¡è§¦å‘çš„æ—¶å€™ï¼Œç«‹åˆ»æ‰§è¡Œä¸€é fnã€‚ä½†æ˜¯ï¼Œä¹Ÿæœ‰å¾ˆå¤šæ—¶å€™å¹¶ä¸æ˜¯è¿™ä¹ˆå¤„ç†çš„ï¼Œè€Œæ˜¯ç›´æ¥é‡‡å–å»¶è¿Ÿå¤„ç†çš„æ–¹å¼ã€‚
  - å…¶å®ï¼Œé˜²æŠ–ä¹Ÿæœ‰è¿™ä¹ˆä¸€ä¸ªé¦–æ¬¡è§¦å‘çš„ç»†èŠ‚é—®é¢˜ï¼Œå…·ä½“è¦å¦‚ä½•å¤„ç†ï¼Œçœ‹å…·ä½“çš„éœ€æ±‚è€Œå®šã€‚ä¸è¿‡ï¼Œé¦–æ¬¡ä¸è§¦å‘çš„æƒ…å†µä¼šæ›´åŠ å¸¸è§ä¸€äº›ã€‚
- **é—®ï¼šåœ¨ fn è¢«è§¦å‘æ—¶ï¼ˆå³ 10ms æ—¶ï¼Œè®°ä½œ fn1ï¼‰ï¼Œéœ€è¦è¿›å…¥å»¶è¿Ÿç­‰å¾…é˜¶æ®µï¼Œåœ¨è¿™ä¸ªé˜¶æ®µä¸­å†å»è§¦å‘ fnï¼ˆè®°ä½œ fn2ï¼‰ï¼Œè¿™ä¸ª fn2 çš„è°ƒç”¨æ˜¯å¦éœ€è¦è¢«è®°å½•ä¸‹æ¥ï¼Œç­‰ä¸Šä¸€ä¸ªé˜¶æ®µçš„ fn1 è°ƒç”¨ç»“æŸåå†è°ƒç”¨å»¶è¿Ÿ 50ms è°ƒç”¨ fn2ï¼Ÿ**
  - ç­”ï¼šè¿˜æ˜¯éƒ½è¡Œï¼Œå¾—çœ‹å…·ä½“è¦æ±‚ã€‚
  - æ¯”å¦‚ LeetCode ä¸Šçš„é¢˜ç›®å°±è¦æ±‚åœ¨è¦æŠŠé‚£äº›åœ¨å»¶è¿ŸæœŸé—´è§¦å‘çš„äº‹ä»¶ä»¥åŠå‚æ•°éƒ½ç»™è®°å½•ä¸‹æ¥ï¼Œç­‰å¾…å»¶è¿Ÿç»“æŸåï¼Œå†æ‹¿æ¥æ‰§è¡Œã€‚
  - ä½†æ˜¯ï¼Œä¹Ÿæœ‰å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šåœ¨æœ‰è®¡æ—¶å™¨çš„æƒ…å†µä¸‹ç›´æ¥ returnï¼Œä¸å»ç®¡é‚£äº›åœ¨ delay æœŸé—´è§¦å‘çš„äº‹ä»¶ã€‚
- **èŠ‚æµçš„å®ç°**
  - èŠ‚æµçš„åŸç†æ˜¯åœ¨è§¦å‘äº‹ä»¶åè®¾ç½®è®¡æ—¶å™¨ã€‚åœ¨è®¡æ—¶å™¨å»¶è¿Ÿè¿‡ç¨‹ä¸­ï¼Œå³ä½¿äº‹ä»¶å†æ¬¡è§¦å‘ï¼Œè®¡æ—¶å™¨çš„å»¶è¿Ÿæ—¶é—´ä¹Ÿä¸ä¼šæ”¹å˜ã€‚åœ¨è®¡æ—¶å™¨æ‰§è¡ŒåŠŸèƒ½ä¹‹å‰ï¼Œè®¡æ—¶å™¨ä¸ä¼šå¤ä½ã€‚

```javascript
var throttle = function (fn, t) {
  const now = Date.now

  let timer
  let nextTimeToCallFn = 0
  return (...args) => {
    const delay = Math.max(0, nextTimeToCallFn - now())
    clearTimeout(timer)
    timer = setTimeout(() => {
      fn(...args)
      nextTimeToCallFn = now() + t
    }, delay)
  }
}
```

## 5. ğŸ“’ é˜²æŠ– vs. èŠ‚æµ

- **é˜²æŠ–**ï¼šç¡®ä¿åœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰æ–°çš„äº‹ä»¶è§¦å‘åï¼Œæ‰æ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚å®ƒé€‚ç”¨äºç”¨æˆ·åœæ­¢é¢‘ç¹æ“ä½œåæ‰éœ€è¦æ‰§è¡Œå‡½æ•°çš„åœºæ™¯ã€‚
- **èŠ‚æµ**ï¼šé™åˆ¶å‡½æ•°åœ¨ä¸€å®šæ—¶é—´é—´éš”å†…æœ€å¤šæ‰§è¡Œä¸€æ¬¡ï¼Œé€‚ç”¨äºé«˜é¢‘ç‡è§¦å‘ä½†å¸Œæœ›åœ¨æŒ‡å®šæ—¶é—´é—´éš”å†…æ‰§è¡Œå›ºå®šæ¬¡æ•°çš„åœºæ™¯ã€‚
- **åº”ç”¨åœºæ™¯ä¸¾ä¾‹**

```javascript
// ã€debounceã€‘
// æœç´¢æ¡†è¾“å…¥
// ç”¨æˆ·è¾“å…¥æ—¶å®æ—¶æœç´¢ï¼Œä½†å¸Œæœ›åªåœ¨ç”¨æˆ·åœæ­¢è¾“å…¥åä¸€æ®µæ—¶é—´æ‰å‘èµ·æœç´¢è¯·æ±‚ã€‚
input.addEventListener('input', debounce(handleSearch, 300))

// çª—å£å¤§å°è°ƒæ•´
// ç”¨æˆ·è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°æ—¶ï¼Œé‡æ–°å¸ƒå±€æˆ–æ¸²æŸ“é¡µé¢ï¼Œåªåœ¨ç”¨æˆ·åœæ­¢è°ƒæ•´çª—å£å¤§å°åè¿›è¡Œæ“ä½œã€‚
window.addEventListener('resize', debounce(handleResize, 200))

// è¡¨å•éªŒè¯
// ç”¨æˆ·è¾“å…¥è¡¨å•å†…å®¹æ—¶ï¼Œå®æ—¶éªŒè¯ä½†å¸Œæœ›åªåœ¨ç”¨æˆ·åœæ­¢è¾“å…¥åè¿›è¡ŒéªŒè¯ã€‚
input.addEventListener('input', debounce(validateInput, 300))

// ã€throttleã€‘
// æ»šåŠ¨äº‹ä»¶
// é¡µé¢æ»šåŠ¨æ—¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼Œé¿å…å› ä¸ºé«˜é¢‘ç‡æ»šåŠ¨äº‹ä»¶å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚
window.addEventListener('scroll', throttle(handleScroll, 100))

// çª—å£å¤§å°è°ƒæ•´
// ç”¨æˆ·è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°æ—¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡é‡æ–°å¸ƒå±€æˆ–æ¸²æŸ“æ“ä½œã€‚
window.addEventListener('resize', throttle(handleResize, 200))

// æŒ‰é’®ç‚¹å‡»
// é˜²æ­¢ç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œç¡®ä¿åœ¨è§„å®šæ—¶é—´å†…æŒ‰é’®ç‚¹å‡»äº‹ä»¶åªè§¦å‘ä¸€æ¬¡ã€‚
button.addEventListener('click', throttle(handleClick, 500))

// æ‹–æ‹½äº‹ä»¶
// ç”¨æˆ·æ‹–æ‹½å…ƒç´ æ—¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ›´æ–°ä¸€æ¬¡ä½ç½®ï¼Œé¿å…é¢‘ç¹è®¡ç®—å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚
element.addEventListener('drag', throttle(handleDrag, 100))
```

- æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©é€‚åˆçš„æ–¹æ³•ï¼Œç›®çš„åœ¨äºè§£å†³ç”±äºäº‹ä»¶é«˜é¢‘è§¦å‘å¯¼è‡´çš„ä¸€äº›ç±»ä¼¼æ€§èƒ½æ–¹é¢çš„é—®é¢˜ã€‚

## 6. ğŸ’» demos.1 - é˜²æŠ–

```html
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>é˜²æŠ–ç¤ºä¾‹</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      #errTip {
        margin-top: 20px;
        color: red;
      }
    </style>
  </head>
  <body>
    <h1>é˜²æŠ–ï¼ˆDebounceï¼‰ç¤ºä¾‹</h1>
    <input type="text" id="inputField" placeholder="è¾“å…¥å†…å®¹..." />
    <div id="errTip"></div>

    <script>
      function debounce(fn, delay) {
        let timer = null
        return function (...args) {
          if (timer) clearTimeout(timer)
          timer = setTimeout(() => {
            timer = null
            fn.apply(this, args)
          }, delay || 1000 / 60)
        }
      }

      const inputField = document.getElementById('inputField')
      const errTip = document.getElementById('errTip')

      function handleInput(event) {
        errTip.textContent = `${event.target.value} ä¸æ»¡è¶³è¦æ±‚ ...`
      }

      const debouncedHandleInput = debounce(handleInput, 300)

      inputField.addEventListener('input', debouncedHandleInput)
    </script>
  </body>
</html>
```

- ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2024-12-31-17-37-47.png)
- å½“ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å†…å®¹æ—¶ï¼Œè¾“å…¥äº‹ä»¶ä¼šè¢«é˜²æŠ–å‡½æ•°å¤„ç†ï¼Œåªæœ‰åœ¨ç”¨æˆ·åœæ­¢è¾“å…¥ 300 æ¯«ç§’åï¼Œæ‰ä¼šæ›´æ–°æ˜¾ç¤ºçš„å†…å®¹ã€‚è¿™æ ·å¯ä»¥é¿å…é¢‘ç¹çš„äº‹ä»¶è§¦å‘ï¼Œæé«˜æ€§èƒ½ã€‚

## 7. ğŸ’» demos.2 - èŠ‚æµ

```html
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>èŠ‚æµç¤ºä¾‹</title>
  </head>
  <body>
    <h1>èŠ‚æµï¼ˆThrottleï¼‰ç¤ºä¾‹</h1>
    <p>å°è¯•æ”¹å˜æµè§ˆå™¨çª—å£å¤§å°ï¼Œçœ‹çœ‹æ§åˆ¶å°çš„è¾“å‡ºã€‚</p>

    <script>
      // å®šä¹‰èŠ‚æµå‡½æ•°
      var throttle = function (fn, delay) {
        let lastCall = 0
        return function (...args) {
          const now = Date.now()
          if (now - lastCall >= delay) {
            lastCall = now
            fn.apply(this, args)
          }
        }
      }

      // ä½¿ç”¨èŠ‚æµå‡½æ•°åŒ…è£…çš„å‡½æ•°
      const logWindowSize = throttle(() => {
        console.log(`Window size: ${window.innerWidth} x ${window.innerHeight}`)
      }, 250) // è®¾ç½®å»¶è¿Ÿæ—¶é—´ä¸º 250 æ¯«ç§’

      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      window.addEventListener('resize', logWindowSize)
    </script>
  </body>
</html>
```

- ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2024-12-31-17-38-06.png)
