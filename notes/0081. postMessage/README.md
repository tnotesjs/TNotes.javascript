# [0081. postMessage](https://github.com/tnotesjs/TNotes.javascript/tree/main/notes/0081.%20postMessage)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„è®º](#2--è¯„è®º)
- [3. ğŸ“’ `postMessage`](#3--postmessage)
- [4. ğŸ’» demos.1 - ä½¿ç”¨ postMessage å®ç°è·¨æ ‡ç­¾é¡µé€šä¿¡](#4--demos1---ä½¿ç”¨-postmessage-å®ç°è·¨æ ‡ç­¾é¡µé€šä¿¡)
- [5. ğŸ”— å¼•ç”¨](#5--å¼•ç”¨)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- `postMessage`

## 2. ğŸ«§ è¯„è®º

- é¢è¯•é¢˜å¯èƒ½ä¼šé‡åˆ°ï¼šä½ éƒ½çŸ¥é“å“ªäº›å®ç°è·¨æ ‡ç­¾é€šä¿¡çš„æ–¹å¼ï¼Ÿ
  - è¦çŸ¥é“ï¼Œä½¿ç”¨ `postMessage` æ˜¯å®ç°è·¨æ ‡ç­¾é¡µé€šä¿¡çš„ä¸€ç§æ–¹æ¡ˆã€‚
- demos.1 é€šè¿‡ `postMessage` æ¥æ¨¡æ‹Ÿäº†ä¸¤ä¸ªé¡µé¢ä¹‹é—´çš„é€šä¿¡æ•ˆæœã€‚

## 3. ğŸ“’ `postMessage`

- `postMessage` API å¯ç”¨äºå®ç°ä¸åŒçª—å£ã€æ ‡ç­¾é¡µæˆ– iframe ä¹‹é—´çš„å®‰å…¨é€šä¿¡ã€‚
- `postMessage` å…è®¸ä½ å‘å¦ä¸€ä¸ªæµè§ˆä¸Šä¸‹æ–‡ï¼ˆå¦‚æ–°æ‰“å¼€çš„çª—å£ã€iframe ç­‰ï¼‰å‘é€æ¶ˆæ¯ï¼Œå¹¶å¯ä»¥æ¥æ”¶æ¥è‡ªè¿™äº›ä¸Šä¸‹æ–‡çš„æ¶ˆæ¯ã€‚

## 4. ğŸ’» demos.1 - ä½¿ç”¨ postMessage å®ç°è·¨æ ‡ç­¾é¡µé€šä¿¡

::: code-group

<<< ./demos/1/send.html {}

<<< ./demos/1/send.js {}

<<< ./demos/1/receive.html {}

<<< ./demos/1/receive.js {}

:::

- è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `postMessage` åœ¨ä¸¤ä¸ªä¸åŒçš„æ ‡ç­¾é¡µä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚è¿™ä¸ªä¾‹å­åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šä¸€ä¸ªé¡µé¢ `send.html` ç”¨æ¥å‘é€æ¶ˆæ¯ï¼Œå¦ä¸€ä¸ªé¡µé¢ `receive.html` ç”¨æ¥æ¥æ”¶æ¶ˆæ¯ã€‚
- æµ‹è¯•æµç¨‹
  - 1ï¸âƒ£ æ‰“å¼€ `send.html` é¡µé¢ï¼ˆæ³¨æ„ï¼Œä»¥ Live server çš„å½¢å¼å¯åŠ¨ï¼‰
  - 2ï¸âƒ£ ç‚¹å‡»æŒ‰é’® `Open Win`ï¼Œæ­¤æ—¶ä¼šæ‰“å¼€ `receive.html` é¡µé¢ï¼Œæ­¤æ—¶ `send.html` è¿˜æ²¡é€šè¿‡ `postMessage` ç»™ `receive.html` å‘é€æ¶ˆæ¯
  - 3ï¸âƒ£ åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä»»æ„å†…å®¹ï¼Œç„¶åç‚¹å‡» `Send Message` æŒ‰é’®
  - 4ï¸âƒ£ åˆ‡æ¢åˆ° `receive.html` é¡µé¢ï¼ŒæŸ¥çœ‹æ”¶åˆ°çš„æ¶ˆæ¯

::: swiper

![1](https://cdn.jsdelivr.net/gh/tnotesjs/imgs@main/2025-09-03-22-17-27.png)

![2](https://cdn.jsdelivr.net/gh/tnotesjs/imgs@main/2025-09-03-22-17-41.png)

![3](https://cdn.jsdelivr.net/gh/tnotesjs/imgs@main/2025-09-03-22-17-48.png)

![4](https://cdn.jsdelivr.net/gh/tnotesjs/imgs@main/2025-09-03-22-19-41.png)

:::

- ä¸€äº›æ³¨æ„äº‹é¡¹
  - **å®‰å…¨æ€§é—®é¢˜**ï¼Œå§‹ç»ˆæ£€æŸ¥ `event.origin`ï¼Œç¡®ä¿æ¶ˆæ¯æ¥è‡ªä½ ä¿¡ä»»çš„æºã€‚è¿™å¯ä»¥é˜²æ­¢æ¶æ„ç½‘ç«™å‘é€ä¼ªé€ æ¶ˆæ¯ã€‚ä¹Ÿå¯ä»¥é€šè¿‡å…¶å®ƒè‡ªå®šä¹‰æ–¹æ¡ˆï¼ŒåŠ ä¸Šèº«ä»½éªŒè¯çš„é€»è¾‘ã€‚
  - **è·¨åŸŸé™åˆ¶é—®é¢˜**ï¼Œ`postMessage` æ”¯æŒè·¨åŸŸé€šä¿¡ï¼Œä½†éœ€è¦æ­£ç¡®è®¾ç½® `targetOrigin` å‚æ•°ï¼Œç¡®ä¿åªå°†æ¶ˆæ¯å‘é€ç»™æ­£ç¡®çš„æ¥æ”¶è€…ã€‚
  - **æ€§èƒ½é—®é¢˜**ï¼Œé¢‘ç¹çš„è·¨çª—å£é€šä¿¡å¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“ï¼Œç‰¹åˆ«æ˜¯å½“æ¶‰åŠå¤§é‡æ•°æ®ä¼ è¾“æ—¶ã€‚

## 5. ğŸ”— å¼•ç”¨

- [mdn - window.postMessage][1]

[1]: https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage
