# [0079. window.onbeforeunload](https://github.com/Tdahuyou/TNotes.html-css-js/tree/main/notes/0079.%20window.onbeforeunload)

<!-- region:toc -->

- [1. ğŸ“ æ¦‚è¿°](#1--æ¦‚è¿°)
- [2. ğŸ“’ `window.onbeforeunload`](#2--windowonbeforeunload)
- [3. ğŸ’» demos.1 - window.onbeforeunload åŸºæœ¬ä½¿ç”¨](#3--demos1---windowonbeforeunload-åŸºæœ¬ä½¿ç”¨)
- [4. ğŸ”— References](#4--references)

<!-- endregion:toc -->

## 1. ğŸ“ æ¦‚è¿°

- çŸ¥è¯†ç‚¹ï¼š
  - æŒæ¡ `window.onbeforeunload` çš„åŸºæœ¬ä½¿ç”¨
- è¯„ä»·ï¼š
  - åœ¨ chrome ä¸Šæ— æ³•é…ç½®å¼¹å‡ºçš„æç¤ºå†…å®¹ï¼Œã€1ã€‘ç»™ `window.onbeforeunload` èµ‹å€¼çš„å‡½æ•°è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²å’Œã€2ã€‘é…ç½® `event.returnValue` ä¸ºæŒ‡å®šå†…å®¹ï¼Œæœ€ç»ˆã€1ã€‘ã€ã€2ã€‘çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚åœ¨å…¶å®ƒæµè§ˆå™¨ä¸Šæ²¡æœ‰åšå¤šæµ‹è¯•ã€‚

## 2. ğŸ“’ `window.onbeforeunload`

- `window.onbeforeunload`
  - `window.onbeforeunload` æ˜¯ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œå®ƒç”¨äºåœ¨çª—å£ã€é¡µé¢æˆ–æ ‡ç­¾å³å°†å¸è½½æ—¶è§¦å‘ã€‚
  - ä½¿ç”¨ `onbeforeunload` äº‹ä»¶å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†ç»™ç”¨æˆ·ï¼Œè¯¢é—®ä»–ä»¬æ˜¯å¦çœŸçš„è¦ç¦»å¼€é¡µé¢ã€‚
  - **å½“ç”¨æˆ·å°è¯•å…³é—­æµè§ˆå™¨çª—å£ã€åˆ·æ–°é¡µé¢ã€å¯¼èˆªåˆ°å¦ä¸€ä¸ªé¡µé¢æˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ç¦»å¼€å½“å‰é¡µé¢æ—¶**ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè¢«è§¦å‘ã€‚
  - **è¿™åœ¨ç”¨æˆ·æ­£åœ¨ç¼–è¾‘è¡¨å•æˆ–å…¶ä»–æ•°æ®è€Œå°šæœªä¿å­˜çš„æƒ…å†µä¸‹ç‰¹åˆ«æœ‰ç”¨**ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ç§é˜²æ­¢æ„å¤–ä¸¢å¤±å·¥ä½œçš„æ–¹å¼ã€‚
- æ³¨æ„ï¼š
  - æ»¥ç”¨ `onbeforeunload` å¯èƒ½ä¼šå¯¼è‡´ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒï¼Œåº”è°¨æ…ä½¿ç”¨ï¼Œä»…åœ¨å¿…è¦æ—¶æé†’ç”¨æˆ·ã€‚

## 3. ğŸ’» demos.1 - window.onbeforeunload åŸºæœ¬ä½¿ç”¨

- åœ¨é¡µé¢ä¸Šæ’å…¥ä»¥ä¸‹è„šæœ¬ï¼Œå½“é¡µé¢è¦è¢«å…³é—­æˆ–è€…åˆ·æ–°çš„æ—¶å€™ï¼Œä¼šå¼¹å‡ºç¡®è®¤æç¤ºæ¡†ã€‚

```javascript {10}
window.onbeforeunload = function (event) {
  // è®¾ç½®å¯¹è¯æ¡†ä¸­çš„æ¶ˆæ¯ï¼ˆæ³¨æ„ï¼šç°ä»£æµè§ˆå™¨å¯èƒ½å¿½ç•¥è‡ªå®šä¹‰æ¶ˆæ¯ï¼‰
  event.returnValue = 'æ‚¨ç¡®å®šè¦ç¦»å¼€æ­¤é¡µé¢å—ï¼Ÿæœªä¿å­˜çš„æ•°æ®å°†ä¼šä¸¢å¤±ã€‚'
  // è¿”å›ç›¸åŒçš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯å¿…éœ€çš„ï¼Œä»¥ç¡®ä¿å…¼å®¹æ€§
  return event.returnValue
}
// ä»¥ chrome ä¸ºä¾‹ï¼Œæˆ‘ä»¬é…ç½®çš„æ–‡æ¡ˆå¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œè€Œæ˜¯ä½¿ç”¨æµè§ˆå™¨é¢„è®¾å¥½çš„å›ºå®šæ–‡æ¡ˆã€‚

// å…¶å®åªéœ€è¦è®© window.onbeforeunload ç»‘å®šçš„å‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒå°±èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚
window.onbeforeunload = () => ''
// è¿™ä¹ˆå†™ï¼Œä¹Ÿä¼šåœ¨é¡µé¢è¢«å…³é—­æˆ–è€…åˆ·æ–°ä¹‹å‰ï¼Œè§¦å‘ä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†ã€‚
```

::: code-group

<<< ./demos/1/1.html {}

<<< ./demos/1/2.html {}

:::

- å…³é—­é¡µé¢ï¼š
  - ![å›¾ 0](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-08-21-11-13-18.png)
- åˆ·æ–°é¡µé¢ï¼š
  - ![img](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-01-02-09-46-36.png)

## 4. ğŸ”— References

- https://developer.mozilla.org/zh-CN/docs/Web/API/Window/beforeunload_event
  - mdn - window.onbeforeunload
